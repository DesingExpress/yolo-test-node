define(["#extension:rc_dock","@design-express/fabrica","@mui/material","crypto","react","react/jsx-runtime"],(function(e,n,t,r,a,i){return(dxnexivil["webpackChunkeuntae90_yolov8-nxv"]=dxnexivil["webpackChunkeuntae90_yolov8-nxv"]||[]).push([[470],{1762:function(e,n,t){t.r(n),t.d(n,{YOLOv8NXV:function(){return U}});var r,a=t(4165),i=t(5861),o=t(5671),c=t(3144),s=t(9340),u=t(2882),l=t(1592),d=(t(891),t(7763)),f=t(8152),p=t(4942),h=t(2650),v=t(8537),g=t(5972),m=JSON.parse('["person","bicycle","car","motorcycle","airplane","bus","train","truck","boat","traffic light","fire hydrant","stop sign","parking meter","bench","bird","cat","dog","horse","sheep","cow","elephant","bear","zebra","giraffe","backpack","umbrella","handbag","tie","suitcase","frisbee","skis","snowboard","sports ball","kite","baseball bat","baseball glove","skateboard","surfboard","tennis racket","bottle","wine glass","cup","fork","knife","spoon","bowl","banana","apple","sandwich","orange","broccoli","carrot","hot dog","pizza","donut","cake","chair","couch","potted plant","bed","dining table","toilet","tv","laptop","mouse","remote","keyboard","cell phone","microwave","oven","toaster","sink","refrigerator","book","clock","vase","scissors","teddy bear","hair drier","toothbrush"]'),x=function(e,n,t,r,a){var i=e.getContext("2d");i.clearRect(0,0,i.canvas.width,i.canvas.height);var o=new b,c="".concat(Math.max(Math.round(Math.max(i.canvas.width,i.canvas.height)/40),14),"px Arial");i.font=c,i.textBaseline="top";for(var s=0;s<t.length;++s){var u=m[r[s]],l=o.get(r[s]),d=(100*t[s]).toFixed(1),p=n.slice(4*s,4*(s+1)),h=(0,f.Z)(p,4),v=h[0],g=h[1],x=h[2],y=h[3],w=(y*=a[0])-(g*=a[0]),k=(x*=a[1])-(v*=a[1]);i.fillStyle=b.hexToRgba(l,.2),i.fillRect(g,v,w,k),i.strokeStyle=l,i.lineWidth=Math.max(Math.min(i.canvas.width,i.canvas.height)/200,2.5),i.strokeRect(g,v,w,k),i.fillStyle=l;var j=i.measureText(u+" - "+d+"%").width,C=parseInt(c,10),Z=v-(C+i.lineWidth);i.fillRect(g-1,Z<0?0:Z,j+i.lineWidth,C+i.lineWidth),i.fillStyle="#ffffff",i.fillText(u+" - "+d+"%",g-1,Z<0?0:Z)}},b=function(){var e=(0,c.Z)((function e(){var n=this;(0,o.Z)(this,e),this.get=function(e){return n.palette[Math.floor(e)%n.n]},this.palette=["#FF3838","#FF9D97","#FF701F","#FFB21D","#CFD231","#48F90A","#92CC17","#3DDB86","#1A9334","#00D4BB","#2C99A8","#00C2FF","#344593","#6473FF","#0018EC","#8438FF","#520085","#CB38FF","#FF95C8","#FF37C7"],this.n=this.palette.length}));return e.hexToRgba=function(e,n){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?"rgba(".concat([parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)].join(", "),", ").concat(n,")"):null},e}(),y=m.length,w=function(e,n,t){var r,a;return[g.lub((function(){var i=g.Xhn.fromPixels(e),o=i.shape.slice(0,2),c=(0,f.Z)(o,2),s=c[0],u=c[1],l=Math.max(u,s),d=i.pad([[0,l-s],[0,l-u],[0,0]]);return r=l/u,a=l/s,g.BHj.resizeBilinear(d,[n,t]).div(255).expandDims(0)})),r,a]},k=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n,t,r){var i,o,c,s,u,l,d,p,h,v,m,b,k,j,C,Z,O,R,F,L,S=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=S.length>3&&void 0!==S[3]?S[3]:function(){},o=t.inputShape.slice(1,3),c=(0,f.Z)(o,2),s=c[0],u=c[1],g.SRH().startScope(),l=w(n,s,u),d=(0,f.Z)(l,3),p=d[1],h=d[2],v=t.net.execute(d[0]),m=v.transpose([0,2,1]),b=g.lub((function(){var e=m.slice([0,0,2],[-1,-1,1]),n=m.slice([0,0,3],[-1,-1,1]),t=g.luU(m.slice([0,0,0],[-1,-1,1]),g.hiC(e,2)),r=g.luU(m.slice([0,0,1],[-1,-1,1]),g.hiC(n,2));return g.zoF([r,t,g.IHx(r,n),g.IHx(t,e)],2).squeeze()})),k=g.lub((function(){var e=m.slice([0,0,4],[-1,-1,y]).squeeze(0);return[e.max(1),e.argMax(1)]})),j=(0,f.Z)(k,2),C=j[0],Z=j[1],e.next=10,g.BHj.nonMaxSuppressionAsync(b,C,500,.45,.2);case 10:R=b.gather(O=e.sent,0).dataSync(),F=C.gather(O,0).dataSync(),L=Z.gather(O,0).dataSync(),x(r,R,F,L,[p,h]),g.B90([v,m,b,C,Z,O]),i(),g.SRH().endScope();case 18:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),j=function(e,n,t){var r=function(){var o=(0,i.Z)((0,a.Z)().mark((function i(){var o;return(0,a.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==e.videoWidth||null!==e.srcObject){a.next=4;break}return(o=t.getContext("2d")).clearRect(0,0,o.canvas.width,o.canvas.height),a.abrupt("return");case 4:k(e,n,t,(function(){window.requestAnimationFrame(r)}));case 5:case"end":return a.stop()}}),i)})));return function(){return o.apply(this,arguments)}}();r()},C=function(){return(0,c.Z)((function e(){(0,o.Z)(this,e),this.open=function(e){window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia?window.navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}}).then((function(n){e.srcObject=n})):window.alert("Can't open Webcam!")},this.close=function(e){e.srcObject?(e.srcObject.getTracks().forEach((function(e){e.stop()})),e.srcObject=null):window.alert("Please open Webcam first!")}}))}(),Z=t(4064),O=function(e){var n=e.imageRef,t=e.cameraRef,r=e.videoRef,a=(0,h.useState)(null),i=(0,f.Z)(a,2),o=i[0],c=i[1],s=(0,h.useRef)(null),u=(0,h.useRef)(null),l=new C,d=function(){var e=n.current.src;n.current.src="#",URL.revokeObjectURL(e),c(null),s.current.value="",n.current.style.display="none"},p=function(){var e=r.current.src;r.current.src="",URL.revokeObjectURL(e),c(null),u.current.value="",r.current.style.display="none"};return(0,Z.jsxs)("div",{className:"btn-container",children:[(0,Z.jsx)("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:function(e){var t=URL.createObjectURL(e.target.files[0]);n.current.src=t,n.current.style.display="block",c("image")},ref:s}),(0,Z.jsxs)(v.Button,{variant:"outlined",onClick:function(){null===o?s.current.click():"image"===o?d():window.alert("Can't handle more than 1 stream\nCurrently streaming : ".concat(o))},children:["image"===o?"Close":"Open"," Image"]}),(0,Z.jsx)("input",{type:"file",accept:"video/*",style:{display:"none"},onChange:function(e){"image"===o&&d();var n=URL.createObjectURL(e.target.files[0]);r.current.src=n,r.current.addEventListener("ended",(function(){return p()})),r.current.style.display="block",c("video")},ref:u}),(0,Z.jsxs)(v.Button,{variant:"outlined",onClick:function(){null===o||"image"===o?u.current.click():"video"===o?p():window.alert("Can't handle more than 1 stream\nCurrently streaming : ".concat(o))},children:["video"===o?"Close":"Open"," Video"]}),(0,Z.jsxs)(v.Button,{variant:"outlined",onClick:function(){null===o||"image"===o?("image"===o&&d(),l.open(t.current),t.current.style.display="block",c("camera")):"camera"===o?(l.close(t.current),t.current.style.display="none",c(null)):window.alert("Can't handle more than 1 stream\nCurrently streaming : ".concat(o))},children:["camera"===o?"Close":"Open"," Webcam"]})]})},R=(0,v.styled)("div")((function(e){var n,t;return(0,p.Z)(t={position:"relative",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",paddingTop:"50px"},"& > .header",(0,p.Z)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginBottom:"50px"},"& > h1",{margin:"0 auto"})),(0,p.Z)(t,"& > div.btn-container",(0,p.Z)({},"& > button",{margin:"0 8px"})),(0,p.Z)(t,"& > div.content",((0,p.Z)(n={position:"relative",paddingTop:"50px"},"& > img",{display:"none",width:"100%",maxWidth:"720px",maxHeight:"500px"}),(0,p.Z)(n,"& > video",{display:"none",width:"100%",maxWidth:"720px",maxHeight:"500px"}),(0,p.Z)(n,"& > canvas",{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),n)),t}));var F,L=function(e){var n=e.modelUrl,t=e.url,o=(0,h.useState)({net:null,inputShape:[1,0,0,3]}),c=(0,f.Z)(o,2),s=c[0],u=c[1];console.log(n,t);var l=(0,h.useRef)(null),d=(0,h.useRef)(null),p=(0,h.useRef)(null),v=(0,h.useRef)(null);return(0,h.useEffect)((function(){g.Cd_().then((0,i.Z)((0,a.Z)().mark((function e(){var r,i,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.YLj("".concat(n),{onProgress:function(e){},weightUrlConverter:function(e){return t[e]}});case 2:i=g.iUs((r=e.sent).inputs[0].shape),o=r.execute(i),u({net:r,inputShape:r.inputs[0].shape}),v.width=r.inputs[0].shape[1],v.height=r.inputs[0].shape[2],g.B90([o,i]);case 9:case"end":return e.stop()}}),e)}))))}),[]),(0,Z.jsxs)(R,{children:[r||(r=(0,Z.jsx)("div",{className:"header",children:(0,Z.jsx)("h1",{children:"\ud83d\udcf7 YOLOv8 Live Detection App"})})),(0,Z.jsx)(O,{imageRef:l,cameraRef:d,videoRef:p}),(0,Z.jsxs)("div",{className:"content",children:[(0,Z.jsx)("img",{src:"#",alt:"",ref:l,onLoad:function(){return k(l.current,s,v.current)}}),(0,Z.jsx)("video",{autoPlay:!0,muted:!0,ref:d,onPlay:function(){return j(d.current,s,v.current)}}),(0,Z.jsx)("video",{autoPlay:!0,muted:!0,ref:p,onPlay:function(){return j(p.current,s,v.current)}}),(0,Z.jsx)("canvas",{width:v.width,height:v.height,ref:v})]})]})},S=t.p+"assets/96b38b90d1b758494128.json",D={"group1-shard1of4.bin":t.p+"assets/1412fa269cd7771ac809.bin","group1-shard2of4.bin":t.p+"assets/3b13946e3aa40260c1cb.bin","group1-shard3of4.bin":t.p+"assets/41b5f358617e82958afa.bin","group1-shard4of4.bin":t.p+"assets/9180c719b3806d20bf86.bin"},U=function(){var e=function(e){(0,s.Z)(t,e);var n=(0,u.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=n.call(this)).addInput("Models",""),e.addInput("BinFile",""),e.addInput("Canvas",""),e.addOutput("Results","jsx"),e.component=F||(F=(0,Z.jsx)(L,{url:D,modelUrl:S})),e.widget=e.addWidget("button","Execute",null,(function(){(0,d.open)(void 0,{id:"::tmp::test",title:"YOLOv8 Detect",content:e.component})})),e}return(0,c.Z)(t,[{key:"onExecute",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.getInputData(1),console.log(n);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onAction",value:function(e,n){"play"===e&&this.triggerSlot(1,n)}}]),t}(l.Pure);return e.path="YOLOv8",e.title="YOLOv8 NXV",e.description="Object Detection using YOLOv8 and Tensorflow.js",e}()},7763:function(n){n.exports=e},1592:function(e){e.exports=n},8537:function(e){e.exports=t},8938:function(e){if("undefined"===typeof r){var n=new Error("Cannot find module 'crypto'");throw n.code="MODULE_NOT_FOUND",n}e.exports=r},2650:function(e){e.exports=a},4064:function(e){e.exports=i},5410:function(){},8628:function(){},1601:function(){},7792:function(){},4977:function(){}},function(e){return e.O(0,[977],(function(){return e(e.s=1762)})),e.O()}])}));