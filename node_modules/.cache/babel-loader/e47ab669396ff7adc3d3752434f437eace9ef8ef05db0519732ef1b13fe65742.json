{"ast":null,"code":"import _regeneratorRuntime from \"/Users/kim-euntae/Documents/Dev/yolov8-nxv/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/kim-euntae/Documents/Dev/yolov8-nxv/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/kim-euntae/Documents/Dev/yolov8-nxv/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _defineProperty from \"/Users/kim-euntae/Documents/Dev/yolov8-nxv/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar _h, _p;\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { styled } from \"@mui/material\";\nimport * as tf from \"@tensorflow/tfjs\";\nimport \"@tensorflow/tfjs-backend-webgl\";\nimport { detect, detectVideo } from \"../shared/detect\";\nimport ButtonHandler from \"./BtnHandler\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar ContentContainer = /*#__PURE__*/styled(\"div\")(function (_ref) {\n  var theme = _ref.theme;\n  return _defineProperty({\n    width: \"100%\",\n    height: \"100%\"\n  }, \"& > div.content\", {\n    height: \"300px\"\n  });\n});\nfunction ContentsBox(_ref3) {\n  var file = _ref3.file;\n  var _useState = useState({\n      loading: true,\n      progress: 0\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    loading = _useState2[0],\n    setLoading = _useState2[1]; // loading state\n  var _useState3 = useState({\n      net: null,\n      inputShape: [1, 0, 0, 3]\n    }),\n    _useState4 = _slicedToArray(_useState3, 2),\n    model = _useState4[0],\n    setModel = _useState4[1]; // init model & input shape\n\n  var imageRef = useRef(null);\n  var cameraRef = useRef(null);\n  var videoRef = useRef(null);\n  var canvasRef = useRef(null);\n\n  // model configs\n  var modelName = \"yolov8n\";\n  useEffect(function () {\n    tf.ready().then( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var yolov8, dummyInput, warmupResults;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return tf.loadGraphModel(\"\".concat(window.location.href, \"/\").concat(modelName, \"_web_model/model.json\"), {\n              onProgress: function onProgress(fractions) {\n                setLoading({\n                  loading: true,\n                  progress: fractions\n                }); // set loading fractions\n              }\n            });\n          case 2:\n            yolov8 = _context.sent;\n            // load model\n            // warming up model\n            dummyInput = tf.ones(yolov8.inputs[0].shape);\n            warmupResults = yolov8.execute(dummyInput);\n            setLoading({\n              loading: false,\n              progress: 1\n            });\n            setModel({\n              net: yolov8,\n              inputShape: yolov8.inputs[0].shape\n            }); // set model & input shape\n\n            tf.dispose([warmupResults, dummyInput]); // cleanup memory\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    })));\n  }, []);\n  return /*#__PURE__*/_jsxs(ContentContainer, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"header\",\n      children: [_h || (_h = /*#__PURE__*/_jsx(\"h1\", {\n        children: \"\\uD83D\\uDCF7 YOLOv8 Live Detection App\"\n      })), _p || (_p = /*#__PURE__*/_jsxs(\"p\", {\n        children: [\"YOLOv8 live detection application on browser powered by\", \" \", /*#__PURE__*/_jsx(\"code\", {\n          children: \"tensorflow.js\"\n        })]\n      })), /*#__PURE__*/_jsxs(\"p\", {\n        children: [\"Serving : \", /*#__PURE__*/_jsx(\"code\", {\n          className: \"code\",\n          children: modelName\n        })]\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"content\",\n      children: [/*#__PURE__*/_jsx(\"img\", {\n        src: \"#\",\n        alt: \"\",\n        ref: imageRef,\n        onLoad: function onLoad() {\n          return detect(imageRef.current, model, canvasRef.current);\n        }\n      }), /*#__PURE__*/_jsx(\"video\", {\n        autoPlay: true,\n        muted: true,\n        ref: cameraRef,\n        onPlay: function onPlay() {\n          return detectVideo(cameraRef.current, model, canvasRef.current);\n        }\n      }), /*#__PURE__*/_jsx(\"video\", {\n        autoPlay: true,\n        muted: true,\n        ref: videoRef,\n        onPlay: function onPlay() {\n          return detectVideo(videoRef.current, model, canvasRef.current);\n        }\n      }), /*#__PURE__*/_jsx(\"canvas\", {\n        width: model.inputShape[1],\n        height: model.inputShape[2],\n        ref: canvasRef\n      })]\n    }), /*#__PURE__*/_jsx(ButtonHandler, {\n      imageRef: imageRef,\n      cameraRef: cameraRef,\n      videoRef: videoRef\n    })]\n  });\n}\nexport default ContentsBox;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}