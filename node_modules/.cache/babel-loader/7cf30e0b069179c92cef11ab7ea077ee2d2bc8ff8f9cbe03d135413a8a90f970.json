{"ast":null,"code":"import _regeneratorRuntime from \"/Users/kim-euntae/Documents/Dev/yolov8-nxv/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/kim-euntae/Documents/Dev/yolov8-nxv/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/kim-euntae/Documents/Dev/yolov8-nxv/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _defineProperty from \"/Users/kim-euntae/Documents/Dev/yolov8-nxv/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar _div;\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { styled } from \"@mui/material\";\nimport * as tf from \"@tensorflow/tfjs\";\nimport \"@tensorflow/tfjs-backend-webgl\";\nimport { detect, detectVideo } from \"../shared/detect\";\nimport ButtonHandler from \"./BtnHandler\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar ContentContainer = /*#__PURE__*/styled(\"div\")(function (_ref) {\n  var _divContent, _ref2;\n  var theme = _ref.theme;\n  return _ref2 = {\n    position: \"relative\",\n    // height: \"100%\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    paddingTop: \"50px\"\n  }, _defineProperty(_ref2, \"& > .header\", _defineProperty({\n    display: \"flex\",\n    flexDirection: \"column\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginBottom: \"50px\"\n  }, \"& > h1\", {\n    margin: \"0 auto\"\n  })), _defineProperty(_ref2, \"& > div.btn-container\", _defineProperty({}, \"& > button\", {\n    margin: \"0 8px\"\n  })), _defineProperty(_ref2, \"& > div.content\", (_divContent = {\n    position: \"relative\",\n    paddingTop: \"50px\"\n  }, _defineProperty(_divContent, \"& > img\", {\n    display: \"none\",\n    width: \"100%\",\n    maxWidth: \"720px\",\n    maxHeight: \"500px\"\n  }), _defineProperty(_divContent, \"& > video\", {\n    display: \"none\",\n    width: \"100%\",\n    maxWidth: \"720px\",\n    maxHeight: \"500px\"\n  }), _defineProperty(_divContent, \"& > canvas\", {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    width: \"100%\",\n    height: \"100%\"\n  }), _divContent)), _ref2;\n});\nfunction ContentsBox(_ref3) {\n  var modelUrl = _ref3.modelUrl,\n    url = _ref3.url;\n  var _useState = useState({\n      net: null,\n      inputShape: [1, 0, 0, 3]\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    model = _useState2[0],\n    setModel = _useState2[1];\n\n  // console.log(url);\n\n  var imageRef = useRef(null);\n  var cameraRef = useRef(null);\n  var videoRef = useRef(null);\n  var canvasRef = useRef(null);\n  useEffect(function () {\n    tf.ready().then( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var yolov8, dummyInput, warmupResults;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return tf.loadGraphModel(\"\".concat(modelUrl), {\n              onProgress: function onProgress(fractions) {\n                // setLoading({ loading: true, progress: fractions });\n              },\n              weightUrlConverter: function weightUrlConverter(n) {\n                // console.log(n);\n                return url[n];\n              }\n            });\n          case 2:\n            yolov8 = _context.sent;\n            dummyInput = tf.ones(yolov8.inputs[0].shape);\n            warmupResults = yolov8.execute(dummyInput); // setLoading({ loading: false, progress: 1 });\n            setModel({\n              net: yolov8,\n              inputShape: yolov8.inputs[0].shape\n            });\n            canvasRef.width = yolov8.inputs[0].shape[1];\n            canvasRef.height = yolov8.inputs[0].shape[2];\n            tf.dispose([warmupResults, dummyInput]);\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    })));\n  }, []);\n  return /*#__PURE__*/_jsxs(ContentContainer, {\n    children: [_div || (_div = /*#__PURE__*/_jsx(\"div\", {\n      className: \"header\",\n      children: /*#__PURE__*/_jsx(\"h1\", {\n        children: \"\\uD83D\\uDCF7 YOLOv8 Live Detection App\"\n      })\n    })), /*#__PURE__*/_jsx(ButtonHandler, {\n      imageRef: imageRef,\n      cameraRef: cameraRef,\n      videoRef: videoRef\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"content\",\n      children: [/*#__PURE__*/_jsx(\"img\", {\n        src: \"#\",\n        alt: \"\",\n        ref: imageRef,\n        onLoad: function onLoad() {\n          return detect(imageRef.current, model, canvasRef.current);\n        }\n      }), /*#__PURE__*/_jsx(\"video\", {\n        autoPlay: true,\n        muted: true,\n        ref: cameraRef,\n        onPlay: function onPlay() {\n          return detectVideo(cameraRef.current, model, canvasRef.current);\n        }\n      }), /*#__PURE__*/_jsx(\"video\", {\n        autoPlay: true,\n        muted: true,\n        ref: videoRef,\n        onPlay: function onPlay() {\n          return detectVideo(videoRef.current, model, canvasRef.current);\n        }\n      }), /*#__PURE__*/_jsx(\"canvas\", {\n        // width={model.inputShape[1]}\n        // height={model.inputShape[2]}\n        width: canvasRef.width,\n        height: canvasRef.height,\n        ref: canvasRef\n      })]\n    })]\n  });\n}\nexport default ContentsBox;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}